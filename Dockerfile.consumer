# ---- Builder Stage ----
FROM golang:1.23-alpine AS builder

WORKDIR /app
COPY go.mod go.sum ./
RUN go mod download

COPY . .

# Build the consumer binary
RUN go build -o consumer ./cmd/consumer

# ---- Runtime Stage ----
FROM alpine:latest

# Copy the binary from builder
COPY --from=builder /app/consumer /app/consumer

# Run the consumer
ENTRYPOINT ["/app/consumer"]
